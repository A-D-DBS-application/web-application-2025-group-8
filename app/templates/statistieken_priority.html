{% extends "base.html" %}
{% block content %}

<!-- HERO -->
<section class="hero">
  <h1 class="hero-title">Actualiteit van Schriftelijke Vragen</h1>
  <p class="hero-subtitle">
    Welke vragen zijn het meest actueel en spelen sterk in op recente gebeurtenissen? 
  </p>
</section>

<!-- INFO + FILTER -->
<section class="info-section">
  <div class="info-container priority-layout">

    <!-- UITLEG -->
    <div class="priority-uitleg">
      <h2>Hoe wordt de score berekend?</h2>
      <p>
        De <strong>Actualiteitsscore</strong> combineert <strong>recentheid</strong> en <strong>thematische breedte</strong> tot één totaalscore:
      </p>
      <ul>
        <li><strong>Recente vragen</strong> scoren hoger: een pas ingediende vraag kan tot <strong>70 punten</strong> behalen. De score daalt geleidelijk tot een minimum van <strong>15 punten</strong> na 60 dagen.</li>
        <li><strong>Meer thema’s</strong> gekoppeld aan een vraag leveren extra punten op (ongeveer <strong>6 punten per thema</strong>, tot een maximum van <strong>30 punten</strong>).</li>
        <li>De totale score is dus maximaal <strong>100 punten</strong>.</li>
      </ul>
      <p class="priority-legende">
        <span class="score-hoog">Hoog (≥ 80)</span> &nbsp;|&nbsp;
        <span class="score-gemiddeld">Gemiddeld (65 – 79)</span> &nbsp;|&nbsp;
        <span class="score-laag">Laag (&lt; 65)</span>
      </p>
      <p class="priority-tip">
        De maximale score van 100 punten wordt enkel behaald door zeer recente vragen met meerdere thema’s.
      </p>
    </div>

    <!-- FILTER -->
    <div class="priority-filter">
      <form method="get" action="{{ url_for('main.statistieken_priority') }}" class="filters-form">
        <div class="filter-field">
          <label for="thema">Filter op thema</label>
          <select id="thema" name="thema" onchange="this.form.submit()">
            <option value="">-- Alle thema’s --</option>
            {% for thema in themas %}
              <option value="{{ thema.id }}" {% if geselecteerd_thema_id == thema.id|string %}selected{% endif %}>
                {{ thema.naam }}
              </option>
            {% endfor %}
          </select>
        </div>
      </form>
      <p class="filter-uitleg">
        Gebruik deze filter om enkel vragen te tonen waarin een bepaald thema <strong>zeker voorkomt</strong>.  
        Zo kan je snel zien welke recente vragen relevant zijn voor dat onderwerp.
      </p>
    </div>

  </div>
</section>

<!-- TABEL -->
<section class="table-section">
  <div class="table-container">
    <table>
      <thead>
        <tr>
          <th>Onderwerp</th>
          <th>Indiener</th>
          <th>Ingediend</th>
          <th class="td-center"># Thema’s</th>
          <th>Score</th>
          <th>PDF</th>
        </tr>
      </thead>
      <tbody>
        {% if data %}
          {% for item in data %}
          <tr>
            <td>{{ item.onderwerp }}</td>
            <td>{{ item.indiener or '-' }}</td>
            <td>{{ item.ingediend }}</td>
            <td class="td-center">{{ item.aantal_themas }}</td>
            <td>
              {% if item.priority_score >= 80 %}
                <span class="score-hoog">{{ item.priority_score }}</span>
              {% elif item.priority_score >= 65 %}
                <span class="score-gemiddeld">{{ item.priority_score }}</span>
              {% else %}
                <span class="score-laag">{{ item.priority_score }}</span>
              {% endif %}
            </td>
            <td class="td-center">
              {% if item.pdf_url %}
                <a href="{{ item.pdf_url }}" target="_blank" class="pdf-link">PDF</a>
              {% else %}
                -
              {% endif %}
            </td>
          </tr>
          {% endfor %}
        {% else %}
          <tr>
            <td colspan="6" class="geen-data">Nog geen data beschikbaar.</td>
          </tr>
        {% endif %}
      </tbody>
    </table>
  </div>
</section>

{% endblock %}
