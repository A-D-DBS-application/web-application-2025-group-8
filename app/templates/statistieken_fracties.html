{% extends "base.html" %}
{% block content %}

<!-- HERO -->
<section class="hero">
  <h1 class="hero-title">Statistieken per Fractie</h1>
  <p class="hero-subtitle">
    Bekijk hoeveel vragen een fractie stelde over een bepaald thema, in verhouding tot hun totale activiteit Ã©n tot het totale aantal vragen binnen dat thema.
  </p>
</section>

<section class="py-4">
  <div class="container text-center">

    <div class="row g-3 justify-content-center align-items-end">
      <div class="col-auto">
        <label class="fw-semibold me-2">Kies een fractie:</label>
        <select id="fractieSelect" class="form-select">
          <option value="">-- Selecteer fractie --</option>
          {% for f in fracties %}
            <option value="{{ f.id }}">{{ f.naam }}</option>
          {% endfor %}
        </select>
      </div>

      <div class="col-auto">
        <label class="fw-semibold me-2">Kies een thema:</label>
        <select id="themaSelect" class="form-select">
          <option value="">-- Selecteer thema --</option>
          {% for t in themas %}
            <option value="{{ t.id }}">{{ t.naam }}</option>
          {% endfor %}
        </select>
      </div>

      <div class="col-auto">
        <button id="toonBtn" class="btn btn-primary px-4">
          Toon statistieken
        </button>
      </div>
    </div>

    <div id="resultaat" class="mt-4 text-start mx-auto" style="max-width:650px;"></div>

  </div>
</section>

<script>
document.getElementById("toonBtn").addEventListener("click", async () => {
  const fractieId = document.getElementById("fractieSelect").value;
  const themaId = document.getElementById("themaSelect").value;

  if (!fractieId || !themaId) {
    alert("Selecteer zowel een fractie als een thema.");
    return;
  }

  const resp = await fetch(`/statistieken/fractie/data/${fractieId}/${themaId}`);
  const data = await resp.json();

  document.getElementById("resultaat").innerHTML = `
    <div class="card shadow-sm border-0">
      <div class="card-body">
        <h3 class="h4 mb-3">Resultaten</h3>
        <div class="row g-3">
          <!-- Linker blok -->
          <div class="col-md-6">
            <div class="p-3 bg-light rounded">
              <h6 class="text-uppercase text-muted small mb-2">Deze fractie</h6>
              <ul class="list-group list-group-flush">
                <li class="list-group-item bg-light d-flex justify-content-between px-0">
                  <span>Aantal vragen over dit thema</span>
                  <strong>${data.thema_vragen_fractie}</strong>
                </li>
                <li class="list-group-item bg-light d-flex justify-content-between px-0">
                  <span>% van totale vragen fractie</span>
                  <strong>${data.perc_van_fractie}%</strong>
                </li>
              </ul>
            </div>
          </div>

          <!-- Rechter blok -->
          <div class="col-md-6">
            <div class="p-3 bg-light rounded">
              <h6 class="text-uppercase text-muted small mb-2">Alle fracties</h6>
              <ul class="list-group list-group-flush">
                <li class="list-group-item bg-light d-flex justify-content-between px-0">
                  <span>Totaal aantal vragen in dit thema</span>
                  <strong>${data.totaal_vragen_thema}</strong>
                </li>
                <li class="list-group-item bg-light d-flex justify-content-between px-0">
                  <span>% van alle themavragen</span>
                  <strong>${data.perc_van_thema}%</strong>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
  `;
});
</script>

{% endblock %}
